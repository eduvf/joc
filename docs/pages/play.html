---
layout: default
permalink: play.html

title: play
header:
  subtitle: playground
---

<style>
  .editor-wrap {
    display: flex;
  }
  #editor {
    flex: 1;
    border: 1px solid transparent;
  }
  #editor:focus {
    border: 1px solid;
  }
  .toolbar {
    text-align: center;
  }
  #output {
    font-size: small;
  }
</style>

<div class="editor-wrap">
  <pre id="lines">1</pre>
  <pre id="editor" contenteditable></pre>
</div>

<div class="toolbar">
  <button onclick="window.empty()">
    <svg class="remix">
      <use xlink:href="assets/remixicon.symbol.svg#ri-terminal-window-fill"></use>
    </svg>
  </button>
  <button onclick="window.run()">
    <svg class="remix">
      <use xlink:href="assets/remixicon.symbol.svg#ri-play-fill"></use>
    </svg>
  </button>
</div>

<pre id="output"></pre>

<script type="module">
  import { lex, evaluate } from './assets/js/joc.mjs';

  const lines = document.getElementById('lines');
  const editor = document.getElementById('editor');
  const output = document.getElementById('output');

  editor.addEventListener('input', () => {
    // TODO - highlight

    updateLines();
  });

  function updateLines() {
    lines.innerText = '1';
    let n = 2;
    for (let i = 0; i + 1 < editor.innerText.length; i++) {
      if (editor.innerText[i] === '\n') {
        lines.innerText += '\n' + n;
        n++;
      }
    }
  }

  window.run = () => {
    let result = lex(editor.innerText);
    output.innerText += '\n' + evaluate().join('\n') + '\n' + JSON.stringify(result);
  };
  window.empty = () => {
    output.innerText = 'joc 0.0.1';
  };
  window.empty();
</script>
